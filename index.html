<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Gezamenlijk Budgetplan</title>
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#1f2937" />
  <style>
    body {
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      margin: 1rem;
      padding: 1rem;
      background-color: #f9fafb;
      color: #333;
    }

    h1 {
      font-size: 1.5rem;
      color: #1f2937;
      margin-bottom: 1rem;
      text-align: center;
    }

    h2 {
      margin-top: 2rem;
      font-size: 1.2rem;
      color: #374151;
    }

    label {
      display: block;
      margin-top: 1rem;
      font-weight: 500;
    }

    input {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      border: 1px solid #ccc;
      border-radius: 6px;
      font-size: 1rem;
    }

    .output {
      margin-top: 1.5rem;
      background: white;
      padding: 1.25rem;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }

    p {
      margin: 0.5rem 0;
      font-size: 0.95rem;
    }

    .note, .footer-note {
      font-size: 0.9rem;
      color: #555;
      margin: 1rem 0;
      padding: 0.75rem;
      background-color: #eef2f7;
      border-left: 4px solid #3b82f6;
      border-radius: 6px;
    }
  </style>
</head>
<body>
  <h1>Gezamenlijk Budgetplan</h1>

  <label for="incomeUser">Inkomen Lars:</label>
  <input type="number" id="incomeUser" placeholder="Bijv. 4000" />

  <label for="incomePartner">Inkomen Marloes:</label>
  <input type="number" id="incomePartner" placeholder="Bijv. 3200" />

  <label for="jointFixedInput">Gezamenlijke vaste lasten:</label>
  <input type="number" id="jointFixedInput" placeholder="Bijv. 3966.52" value="3966.52">>

    <label for="personalUserInput">Persoonlijke vaste lasten Lars:</label>
  <input type="number" id="personalUserInput" placeholder="Bijv. 384.95" value="384.95" />

  <label for="personalPartnerInput">Persoonlijke vaste lasten Marloes:</label>
  <input type="number" id="personalPartnerInput" placeholder="Bijv. 467.99" value="467.99" />

<div class="output" id="results">
      <p><strong>Totaal inkomen:</strong> € <span id="totalIncome">0.00</span></p>
      <p><strong>Gelijke buffer p.p. (vóór persoonlijke lasten):</strong> € <span id="bufferPerPerson">0.00</span></p>
      <p><strong>Bijdrage vaste lasten Lars:</strong> € <span id="contributionUser">0.00</span></p>
      <p><strong>Bijdrage vaste lasten Marloes:</strong> € <span id="contributionPartner">0.00</span></p>
      <p><strong>Vrij te besteden ná persoonlijke lasten Marloes:</strong> € <span id="netPartner">0.00</span></p>
      <p><strong>Vrij te besteden ná persoonlijke lasten Lars:</strong> € <span id="netUser">0.00</span></p>
      <p id="warning" style="color:#b91c1c; font-weight:600; display:none;"></p>
    </div>

  <div class="footer-note">
    <p>Beide maken we €750 over naar de boodschappenrekening en beide sparen we €75. Deze lasten zijn al meegenomen in de berekening. Het weergegeven vrij te besteden bedrag is dus écht 'vrij te besteden'.</p>
  </div>

  <script>
  const incomeUserInput = document.getElementById('incomeUser');
  const incomePartnerInput = document.getElementById('incomePartner');
  const jointFixedInput = document.getElementById('jointFixedInput');
  const personalUserInput = document.getElementById('personalUserInput');
  const personalPartnerInput = document.getElementById('personalPartnerInput');

  function calculate() {
    const incomeUser = parseFloat(incomeUserInput.value) || 0;
    const incomePartner = parseFloat(incomePartnerInput.value) || 0;

    const jointFixed = parseFloat(jointFixedInput.value) || 0;
    const personalFixedUser = parseFloat(personalUserInput.value) || 0;
    const personalFixedPartner = parseFloat(personalPartnerInput.value) || 0;

    // Iedereen betaalt €825 p.p. (750 boodschappen + 75 sparen)
    const perPersonBase = 825;
    const totalIncome = incomeUser + incomePartner;

    // Gelijke buffer p.p. vóór persoonlijke vaste lasten
    let bufferPerPerson = (totalIncome - 2 * perPersonBase - jointFixed) / 2;
    if (bufferPerPerson < 0) bufferPerPerson = 0;

    // Benodigde bijdragen om die buffer te realiseren
    let contributionUser = Math.max(incomeUser - perPersonBase - bufferPerPerson, 0);
    let contributionPartner = Math.max(incomePartner - perPersonBase - bufferPerPerson, 0);

    // Controle op dekking gezamenlijke vaste lasten
    const covered = contributionUser + contributionPartner;
    const shortfall = jointFixed - covered;

    // Vrij te besteden ná persoonlijke vaste lasten
    const netUser = bufferPerPerson - personalFixedUser;
    const netPartner = bufferPerPerson - personalFixedPartner;

    // UI updates
    document.getElementById('totalIncome').textContent = totalIncome.toFixed(2);
    document.getElementById('bufferPerPerson').textContent = bufferPerPerson.toFixed(2);
    document.getElementById('contributionUser').textContent = contributionUser.toFixed(2);
    document.getElementById('contributionPartner').textContent = contributionPartner.toFixed(2);
    document.getElementById('personalPartner').textContent = personalFixedPartner.toFixed(2);
    document.getElementById('personalUser').textContent = personalFixedUser.toFixed(2);
    document.getElementById('netPartner').textContent = netPartner.toFixed(2);
    document.getElementById('netUser').textContent = netUser.toFixed(2);

    const warn = document.getElementById('warning');
    if (shortfall > 0.005) {
      warn.style.display = 'block';
      warn.textContent = 'Waarschuwing: gezamenlijke vaste lasten zijn niet volledig gedekt. Tekort: € ' + shortfall.toFixed(2);
    } else {
      warn.style.display = 'none';
      warn.textContent = '';
    }
  }

  // Event listeners + init
  incomeUserInput.addEventListener('input', calculate);
  incomePartnerInput.addEventListener('input', calculate);
  jointFixedInput.addEventListener('input', calculate);
  personalUserInput.addEventListener('input', calculate);
  personalPartnerInput.addEventListener('input', calculate);
  calculate();
</script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(() => console.log('Service Worker geregistreerd'))
        .catch(error => console.error('Registratie mislukt:', error));
    }
  </script>
</body>
</html>
